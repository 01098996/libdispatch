{"name":"libdispatch for Linux","tagline":"Linux port of Apple's open-source concurrency library","body":"# libdispatch for Linux\r\n\r\npthreads getting you down? [libdispatch](http://libdispatch.macosforge.org),\r\naka Grand Central Dispatch (GCD) is Apple's high-performance event-handling\r\nlibrary, introduced in OS X Snow Leopard. It provides asynchronous task queues,\r\nmonitoring of file descriptor read and write-ability, asynchronous I/O (for\r\nsockets *and* regular files), readers-writer locks, parallel for-loops, sane\r\nsignal handling, periodic timers, semaphores and more. You'll want to read over\r\nApple's [API reference](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html).\r\n\r\n### Changes from Apple's official version\r\nI've added the ability to integrate libdispatch's main queue with third-party\r\nrun-loops, e.g. GLib's `GMainLoop`.  Call\r\n`dispatch_get_main_queue_handle_np()` to get a file descriptor your run-loop\r\ncan monitor for reading; when it becomes readable call\r\n`dispatch_main_queue_drain_np()` to execute the pending tasks.\r\n\r\nI've also added missing `_f` variants for several functions in `data.h` and\r\n`io.h` that took [Objective-C blocks](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)\r\nonly: look for the functions with `_np` appended to them. Although you can make\r\nfull use of libdispatch with compilers like GCC that don't support blocks, it\r\nis not advisable to build libdispatch itself with anything other than Clang, as\r\nthe dispatch i/o portion cannot be built without compiler support for blocks.\r\n\r\n## Runtime Requirements\r\n- [libBlocksRuntime](https://github.com/mheily/blocks-runtime)\r\n- [libpthread_workqueue](https://github.com/mheily/libpwq)\r\n- [libkqueue](https://github.com/mheily/libkqueue)\r\n\r\n## Build Requirements\r\n- [CMake](http://cmake.org) >= 2.8.7\r\n- [Python2](http://python.org) >= 2.6\r\n- [Clang](http://llvm.org) >= 3.4\r\n\r\n## Getting Started:\r\nOn Ubuntu 12.04 LTS or greater, the required dependencies are available via\r\napt-get. (However it ships with Clang 3.0, which is rather old and is not\r\ntested.)\r\n\r\n    sudo apt-get install libblocksruntime-dev libkqueue-dev libpthread-workqueue-dev cmake\r\n\r\n    git clone git://github.com/nickhutchinson/libdispatch.git && cd libdispatch\r\n    mkdir libdispatch-build && cd libdispatch-build\r\n    ../configure\r\n    make\r\n    sudo make install\r\n\r\n[![Build Status](https://travis-ci.org/nickhutchinson/libdispatch.svg?branch=master)](https://travis-ci.org/nickhutchinson/libdispatch)\r\n\r\n## Known Issues\r\n- 2014-10-01 - Dispatch Sources of type `DISPATCH_SOURCE_TYPE_VNODE` are\r\n  unreliable, and should be avoided for now.\r\n\r\n## Testing\r\nSee the `run-tests.py` script in `testing/`.\r\n\r\n## Demo\r\n\r\n### forever.c\r\n```cpp\r\n#include <dispatch/dispatch.h>\r\n#include <stdio.h>\r\n\r\nstatic void timer_did_fire(void *context) {\r\n    printf(\"Strawberry fields...\\n\");\r\n}\r\n\r\nint main(int argc, const char *argv[]) {\r\n    dispatch_source_t timer = dispatch_source_create(\r\n        DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_main_queue());\r\n\r\n    dispatch_source_set_event_handler_f(timer, timer_did_fire);\r\n    dispatch_source_set_timer(timer, DISPATCH_TIME_NOW, 1 * NSEC_PER_SEC,\r\n                              0.5 * NSEC_PER_SEC);\r\n    dispatch_resume(timer);\r\n    dispatch_main();\r\n}\r\n```\r\n\r\n    > clang forever.c -I/usr/local/include -L/usr/local/lib -ldispatch -o forever\r\n    > ./forever\r\n\r\n    Strawberry fields...\r\n    Strawberry fields...\r\n    Strawberry fields...\r\n    Strawberry fields...\r\n    [...]\r\n\r\n\r\n## Credits\r\nThis port was made possible by Mark Heily and others who contributed the\r\n`libpthread_workqueue` and `libkqueue` libraries that libdispatch depends on, as\r\nwell as numerous portability patches floating around the official libdispatch\r\nmailing list, notably <http://lists.macosforge.org/pipermail/libdispatch-dev/2012-August/000676.html>.\r\n\r\n","google":"UA-36058538-1","note":"Don't delete this file! It's used internally to help with page regeneration."}